<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
	Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
	<class name="bbr.b2b.regional.logistic.deliveries.entities.Delivery" table="DELIVERY"
		entity-name="bbr.b2b.regional.logistic.deliveries.entities.Delivery" schema="LOGISTICA" >
		<id name="id" type="java.lang.Long">
			<column name="ID" />
			<generator class="identity">
				<param name="sequence">DELIVERY_SEQUENCE</param>
				<param name="parameters">AS BIGINT CACHE 100</param>
			</generator>
		</id>

		<property name="number" type="java.lang.Long" not-null="true"></property>		
		<property name="created" type="timestamp"></property>
		<property name="currentstatetypedate" type="timestamp"></property>
		<property name="receptionnumber" type="java.lang.Long"></property>
		<property name="receptiondate" type="timestamp"></property>
		<property name="refdocument" type="java.lang.Long"></property>
		<property name="container" type="java.lang.String"></property>
		<property name="imp" type="java.lang.String"></property>
		<property name="complementscount" type="java.lang.Integer"></property>
		<property name="hasatc" type="java.lang.Boolean"></property>
					
		<many-to-one name="deliverytype"
			class="bbr.b2b.regional.logistic.deliveries.entities.DeliveryType" column="DELIVERYTYPE_ID"
			not-null="true" />		
		<many-to-one name="currentstatetype"
			class="bbr.b2b.regional.logistic.deliveries.entities.DeliveryStateType" column="CURRENTSTATETYPE_ID"
			not-null="true" />	
		<many-to-one name="location"
			class="bbr.b2b.regional.logistic.locations.entities.Location" column="LOCATION_ID" 
			not-null="true" />		
		<many-to-one name="ordertype"
			class="bbr.b2b.regional.logistic.buyorders.entities.OrderType" column="ORDERTYPE_ID"
			not-null="false" />	
		<many-to-one name="flowtype"
			class="bbr.b2b.regional.logistic.items.entities.FlowType" column="FLOWTYPE_ID"
			not-null="true" />	
		<many-to-one name="vendor"
			class="bbr.b2b.regional.logistic.vendors.entities.Vendor" column="VENDOR_ID"
			not-null="true" />	
		
		<sql-query name="getProposedPackingListByDetailOrInnerpack">
			<![CDATA[	
				SELECT
					IT.ID AS ITEMID,
					OC.ID AS ORDERID,
					LO.ID AS LOCATIONID,
					DL.NUMBER AS DELIVERYNUMBER,
					FT.NAME AS FLOWTYPE,
					CAST('' AS text) AS BULKID,
					CAST('' AS text) AS PALLETID,
					IT.NAME AS ITEMDESC,
					LO.CODE AS DESTINATIONCODE,
					DP.CODE AS DEPARTMENTCODE,
					DP.NAME AS DEPARTMENTDESC,
					LO.NAME AS DESTINATIONDESC,
					IT.INTERNALCODE AS ITEMSKU,
					VI.VENDORITEMCODE,
					OC.NUMBER AS ORDERNUMBER,
					ODD.AVAILABLEUNITS AS UNITS,
					CAST(0 AS text) AS TAXNUMBER
				FROM
					LOGISTICA.ORDER AS OC JOIN
					LOGISTICA.ORDERDELIVERY AS ODL ON ODL.ORDER_ID = OC.ID JOIN
					LOGISTICA.DELIVERY AS DL ON DL.ID = ODL.DELIVERY_ID JOIN
					LOGISTICA.ORDERDELIVERYDETAIL AS ODD ON ODD.ORDER_ID = OC.ID AND ODD.DELIVERY_ID = DL.ID JOIN
					LOGISTICA.ITEM AS IT ON IT.ID = ODD.ITEM_ID JOIN
					LOGISTICA.LOCATION AS LO ON LO.ID = ODD.LOCATION_ID JOIN
					LOGISTICA.VENDOR AS VD ON VD.ID = OC.VENDOR_ID JOIN
					LOGISTICA.VENDORITEM AS VI ON VI.ITEM_ID = IT.ID AND VI.VENDOR_ID = VD.ID JOIN
					LOGISTICA.FLOWTYPE AS FT ON FT.ID = IT.FLOWTYPE_ID JOIN
					LOGISTICA.DEPARTMENT AS DP ON DP.ID = OC.DEPARTMENT_ID
				WHERE
					ODD.AVAILABLEUNITS > 0 AND
					DL.ID = :deliveryid AND
					VD.ID = :vendorid
							
			]]>
		</sql-query>
		
		<sql-query name="getLabelDODeliveryReport">
			<![CDATA[
				SELECT
					DL.NUMBER AS DLNUMBER,
					OC.NUMBER AS OCNUMBER,
					DP.CODE AS DEPARTMENTCODE,
					IT.BARCODE,
					IT.INTERNALCODE AS ITEMSKU,
					VI.VENDORITEMCODE,
					IT.NAME AS ITEMDESC,
					IT.COLOR AS ITEMCOLOR,
					IT.DIMENSION AS ITEMDIMENSION,
					IT.SIZE AS ITEMSIZE,
					ODD.AVAILABLEUNITS,
					OD.LISTPRICE,
					OD.FINALPRICE
				FROM
					LOGISTICA.ORDER AS OC JOIN
					LOGISTICA.ORDERDELIVERY AS ODL ON ODL.ORDER_ID = OC.ID JOIN
					LOGISTICA.ORDERDETAIL AS OD ON OD.ORDER_ID = OC.ID JOIN
					LOGISTICA.ITEM AS IT ON IT.ID = OD.ITEM_ID JOIN
					LOGISTICA.DELIVERY AS DL ON DL.ID = ODL.DELIVERY_ID JOIN
					LOGISTICA.ORDERDELIVERYDETAIL AS ODD ON ODD.DELIVERY_ID = DL.ID AND ODD.ITEM_ID = OD.ITEM_ID AND ODD.ORDER_ID = OC.ID JOIN
					LOGISTICA.VENDOR AS VD ON VD.ID = DL.VENDOR_ID JOIN
					LOGISTICA.VENDORITEM AS VI ON VI.VENDOR_ID = VD.ID AND VI.ITEM_ID = IT.ID JOIN
					LOGISTICA.DEPARTMENT AS DP ON DP.ID = OC.DEPARTMENT_ID
				WHERE 
					DL.ID = :deliveryid AND 
					VD.ID = :vendorid
			]]>
		</sql-query>
		
		<sql-query name="getAddedDeliveriesByContainerDeliveryLocationFlowTypeAndATC">
			<![CDATA[
				SELECT
					dl.id AS deliveryid,
					dl.number AS deliverynumber,
					dt.name AS deliverytype,
					ft.name AS flowtype
				FROM
					logistica.delivery AS dl JOIN
					logistica.deliverytype AS dt ON dt.id = dl.deliverytype_id JOIN
					logistica.flowtype AS ft ON ft.id = dl.flowtype_id
				WHERE
					dl.id IN (:deliveryids)
			]]>
		</sql-query>
		
	</class>		
</hibernate-mapping>